---
// news/index.astro - All news listing page
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import NewsCard from "../../components/NewsCard.astro";
import TagCloud from "../../components/TagCloud.astro";

// Fetch all news articles
const allNews = await getCollection("news");

// Sort by date (newest first)
const sortedNews = allNews.sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

// Extract all unique tags
const allTags = [...new Set(allNews.flatMap((news) => news.data.tags))];
---

<BaseLayout
  title="All News - Game News"
  description="Browse all gaming news articles"
>
  <div class="container">
    <!-- Header -->
    <header class="page-header">
      <h1>All News</h1>
      <p class="page-description">
        Browse our complete collection of gaming news and updates
      </p>
    </header>

    <!-- News Grid -->
    <section class="news-section">
      <div class="news-grid">
        {sortedNews.map((news) => <NewsCard news={news} />)}
      </div>

      {
        sortedNews.length === 0 && (
          <p class="empty-state">No news articles found.</p>
        )
      }
    </section>

    <!-- Tag Cloud -->
    <TagCloud tags={allTags} title="Browse by Topic" />
  </div>
</BaseLayout>

<style>
  .page-header {
    padding: var(--space-12) 0 var(--space-8);
    text-align: center;
    border-bottom: 2px solid var(--border-color);
    margin-bottom: var(--space-8);
  }

  .page-header h1 {
    font-family: var(--font-serif);
    font-size: var(--text-4xl);
    font-weight: 900;
    margin-bottom: var(--space-4);
  }

  .page-description {
    font-size: var(--text-lg);
    color: var(--text-secondary);
    max-width: 600px;
    margin: 0 auto;
  }

  .news-section {
    margin-bottom: var(--space-12);
  }

  .empty-state {
    text-align: center;
    padding: var(--space-16);
    font-size: var(--text-lg);
    color: var(--text-muted);
    font-style: italic;
  }

  @media (max-width: 768px) {
    .page-header {
      padding: var(--space-8) 0 var(--space-6);
    }

    .page-header h1 {
      font-size: var(--text-3xl);
    }

    .page-description {
      font-size: var(--text-base);
    }
  }
</style>
